<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<ui:composition template="/templates/main.xhtml">
    <ui:define name="content">
        <h:form>

            <f:metadata>
                <f:viewAction action="#{manageBooksBean.prepare}"/>
            </f:metadata>

            <h2>Ready reservations</h2>

            <h:dataTable border="1" value="#{manageBooksBean.availableBooks}" var="res">
                <h:column>
                    <f:facet name="header">User</f:facet>
                    #{res.user.loginName}
                </h:column>
                <h:column>
                    <f:facet name="header">Book title</f:facet>
                    #{res.book.title}
                </h:column>
                <h:column>
                    <f:facet name="header">Author</f:facet>
                    #{res.book.author}
                </h:column>
                <h:column>
                    <f:facet name="header">Year</f:facet>
                    #{res.book.year}
                </h:column>
                <h:column>
                    <f:facet name="header">Status</f:facet>
                    #{res.status}
                </h:column>
                <h:column>
                    <f:facet name="header">Action</f:facet>
                    <h:commandButton action="#{manageBooksBean.giveBook(res)}" value="Give out!">
                    <f:ajax render="@form" execute="@form"/>
                </h:commandButton>
                </h:column>
            </h:dataTable>


            <h2>Returned books</h2>

            <h:dataTable border="1" value="#{manageBooksBean.takenBooks}" var="taken">
                <h:column>
                    <f:facet name="header">User</f:facet>
                    #{taken.user.loginName}
                </h:column>
                <h:column>
                    <f:facet name="header">Book title</f:facet>
                    #{taken.book.title}
                </h:column>
                <h:column>
                    <f:facet name="header">Author</f:facet>
                    #{taken.book.author}
                </h:column>
                <h:column>
                    <f:facet name="header">Year</f:facet>
                    #{taken.book.year}
                </h:column>
                <h:column>
                    <f:facet name="header">Status</f:facet>
                    #{taken.status}
                </h:column>
                <h:column>
                    <f:facet name="header">Action</f:facet>
                    <h:commandButton action="#{manageBooksBean.takeBook(taken)}" value="Take back!">
                        <f:ajax render="@form" execute="@form"/>
                    </h:commandButton>
                </h:column>
            </h:dataTable>


            <h2>Closed reservations</h2>
            <h:dataTable border="1" value="#{manageBooksBean.closedResult}" var="closed">
                <h:column>
                    <f:facet name="header">User</f:facet>
                    #{closed.user.loginName}
                </h:column>
                <h:column>
                    <f:facet name="header">Book title</f:facet>
                    #{closed.book.title}
                </h:column>
                <h:column>
                    <f:facet name="header">Author</f:facet>
                    #{closed.book.author}
                </h:column>
                <h:column>
                    <f:facet name="header">Year</f:facet>
                    #{closed.book.year}
                </h:column>
                <h:column>
                    <f:facet name="header">Status</f:facet>
                    #{closed.status}
                </h:column>
            </h:dataTable>

        </h:form>
    </ui:define>
</ui:composition>

</html>
